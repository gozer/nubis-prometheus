---
{{if exists "/config/RegionName"}}
region: '{{ getv "/config/RegionName" }}'
{{end}}
metrics:
  # ELB Metrics
- aws_namespace: AWS/ELB
  aws_metric_name: HealthyHostCount
  aws_dimensions: [LoadBalancerName]
  aws_statistics: [Average,Maximum]

- aws_namespace: AWS/ELB
  aws_metric_name: UnHealthyHostCount
  aws_dimensions: [LoadBalancerName]
  aws_statistics: [Average,Maximum]

- aws_namespace: AWS/ELB
  aws_metric_name: BackendConnectionErrors
  aws_dimensions: [LoadBalancerName]
  aws_statistics: [Sum]

- aws_namespace: AWS/ELB
  aws_metric_name: HTTPCode_Backend_2XX_Count
  aws_dimensions: [LoadBalancerName]
  aws_statistics: [Sum]

- aws_namespace: AWS/Backend
  aws_metric_name: HTTPCode_Backend_3XX_Count
  aws_dimensions: [LoadBalancerName]
  aws_statistics: [Sum]

- aws_namespace: AWS/Backend
  aws_metric_name: HTTPCode_Backend_4XX_Count
  aws_dimensions: [LoadBalancerName]
  aws_statistics: [Sum]

- aws_namespace: AWS/Backend
  aws_metric_name: HTTPCode_Backend_5XX_Count
  aws_dimensions: [LoadBalancerName]
  aws_statistics: [Sum]

- aws_namespace: AWS/ELB
  aws_metric_name: HTTPCode_ELB_4XX
  aws_dimensions: [LoadBalancerName]
  aws_statistics: [Sum]

- aws_namespace: AWS/ELB
  aws_metric_name: HTTPCode_ELB_5XX
  aws_dimensions: [LoadBalancerName]
  aws_statistics: [Sum]

- aws_namespace: AWS/ELB
  aws_metric_name: Latency
  aws_dimensions: [LoadBalancerName]
  aws_statistics: [Average,Maximum,Minimum]

- aws_namespace: AWS/ELB
  aws_metric_name: RequestCount
  aws_dimensions: [LoadBalancerName]
  aws_statistics: [Sum]

- aws_namespace: AWS/ELB
  aws_metric_name: SurgeQueueLength
  aws_dimensions: [LoadBalancerName]
  aws_statistics: [Average,Maximum,Minimum]

- aws_namespace: AWS/ELB
  aws_metric_name: SpilloverCount
  aws_dimensions: [LoadBalancerName]
  aws_statistics: [Sum]

  # AWS AutoScaling
- aws_namespace: AWS/AutoScaling
  aws_metric_name: GroupMinSize
  aws_dimensions: [AutoScalingGroupName]
  aws_statistics: [Minimum]

- aws_namespace: AWS/AutoScaling
  aws_metric_name: GroupMaxSize
  aws_dimensions: [AutoScalingGroupName]
  aws_statistics: [Maximum]

- aws_namespace: AWS/AutoScaling
  aws_metric_name: GroupDesiredCapacity
  aws_dimensions: [AutoScalingGroupName]
  aws_statistics: [Minimum,Maximum]

- aws_namespace: AWS/AutoScaling
  aws_metric_name: GroupInServiceInstances
  aws_dimensions: [AutoScalingGroupName]
  aws_statistics: [Minimum,Maximum]

  # AWS Lambda
- aws_namespace: AWS/Lambda
  aws_metric_name: Invocations
  aws_dimensions: [FunctionName]
  aws_statistics: [Minimum,Maximum,Sum]

- aws_namespace: AWS/Lambda
  aws_metric_name: Duration
  aws_dimensions: [FunctionName]
  aws_statistics: [Minimum,Maximum,Sum,Average]

- aws_namespace: AWS/Lambda
  aws_metric_name: Errors
  aws_dimensions: [FunctionName]
  aws_statistics: [Minimum,Maximum,Sum]

# Currently can't do cross-region metrics collection
# And Amazon stores AWS/Billing metrics *only* in us-east-1 for some reason
#---
#region: us-east-1
#metrics:
# - aws_namespace: AWS/Billing
#   range_seconds: 21600
#   aws_metric_name: EstimatedCharges
#   aws_dimensions: [ServiceName,Currency]
#   aws_dimension_select:
#     Currency: [USD]
